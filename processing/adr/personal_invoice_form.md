# Инвойс форма с идентификацией

В текущей реализации инвойс формы не содержат информации о том, кому они предназначены, не содержат экспирации
(ограничения не время заполнения)

## Бизнес требование

Надо сделать, чтоб мерчант дергал ручку и получал бы уникальную ссылку для заполнения формы и оплаты счета. В запросе
мерчант передает какой-то токен, который может содержать любой текст, ограничиваем по длине (пусть 36 символов).

## Техническое решение:

### Хранение

Добавим в таблицу invoice_form поля expires_at, external_id. Их можно будет заполнить как при обычном создании инвойс
формы, так и отдельной ручкой на создание персонализированной формы по общей.

При создании персонализированной формы по общей надо будет создавать новую запись в таблице, копируя все поля общей
формы и добавляя expires_at, external_id. Вариант сделать персонализацию через отдельную таблицу со ссылкой на
форму не подойдет, потому что тогда изменение формы будет менять отображение существующих персональных инвойсов

### Получение из БД

Каждая инвойс-форма (общая и перс) имеет свой уникальный id, так что логика получения формы на фронте не меняется. На
фронт начинаем отдавать expires_at, чтоб фронт мог таймер сделать.

При создании инвойса, если в форме есть expires_at, то надо проверять его и прокидывать его в инвойс, как бы продолжая
общий таймер оплаты счета

### Создание персонализированной инвойс-формы

Надо сделать ручку АПИ для мерчанта

Вход:

```json5
{
  "invoice_form_id": "...",
  "external_id": "...",
  // expires_at is optional in grpc  
  "expires_at": "..."
}
```

Выход:
Аналогично вхыоду при создании инвойс-формы

### Экспирация инвойс-формы
При запроса инвойс-формы после даты экспирации отдаем 404. Сделать воркера, который будет удалять истекшие формы